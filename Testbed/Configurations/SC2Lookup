#!/bin/sh

##H Usage: SC2Lookup -g PROTO FOR-NODE GUID...
##H
##H List GUID/PFN pairs for GUIDs (only -g GUID is supported).
##H
##H This fakes out a catalogue for SC2 transfer challenge from
##H CERN using PhEDEx, returning one of the 40 predetermined
##H test files from SC2 server.
##H
##H The only supported protocol is "srm".

# Pick up options
cat= match= mode= proto= fornode= rewrite=
while [ $# -ge 1 ]; do
  case $1 in
    -g )
      mode=$1; shift ;;
    -h )
      grep "^##H" < $0 | sed 's/^##H\( \|\)//'; exit 1 ;;
    -u )
      shift; shift ;;
    -n )
      shift; suffix=$1; shift ;;
    -* )
      echo "unrecognised option $1" 1>&2; exit 1 ;;
    * )
      break ;;
  esac
done

proto="$1"; shift
fornode="$1"; shift

[ X"$mode" = X ] && { echo "$0: no lookup mode specified" 1>&2; exit 1; }
[ X"$mode" != X-g ] && { echo "$0: lookup mode $mode not supported, '-g' required" 1>&2; exit 1; }
[ X"$proto" = X ] && { echo "$0: no protocol specified" 1>&2; exit 1; }
[ X"$fornode" = X ] && { echo "$0: no destination node specified" 1>&2; exit 1; }

lfnbase=$proto://radiantservice.cern.ch:8443/castor/cern.ch/grid/dteam/storage/transfer-test/sample-file-1gig.$suffix
for guid; do
  case $guid in
    ??????[0A][0123]-*) echo $guid $lfnbase-00.dat ;;
    ??????[0A][4567]-*) echo $guid $lfnbase-01.dat ;;
    ??????[0A][89AB]-*) echo $guid $lfnbase-02.dat ;;
    ??????[0A][CDEF]-*) echo $guid $lfnbase-03.dat ;;

    ??????[1B][0123]-*) echo $guid $lfnbase-04.dat ;;
    ??????[1B][4567]-*) echo $guid $lfnbase-05.dat ;;
    ??????[1B][89AB]-*) echo $guid $lfnbase-06.dat ;;
    ??????[1B][CDEF]-*) echo $guid $lfnbase-07.dat ;;

    ??????[2C][0123]-*) echo $guid $lfnbase-08.dat ;;
    ??????[2C][4567]-*) echo $guid $lfnbase-09.dat ;;
    ??????[2C][89AB]-*) echo $guid $lfnbase-10.dat ;;
    ??????[2C][CDEF]-*) echo $guid $lfnbase-11.dat ;;

    ??????[3D][0123]-*) echo $guid $lfnbase-12.dat ;;
    ??????[3D][4567]-*) echo $guid $lfnbase-13.dat ;;
    ??????[3D][89AB]-*) echo $guid $lfnbase-14.dat ;;
    ??????[3D][CDEF]-*) echo $guid $lfnbase-15.dat ;;

    ??????[4E][0123]-*) echo $guid $lfnbase-16.dat ;;
    ??????[4E][4567]-*) echo $guid $lfnbase-17.dat ;;
    ??????[4E][89AB]-*) echo $guid $lfnbase-18.dat ;;
    ??????[4E][CDEF]-*) echo $guid $lfnbase-19.dat ;;

    ??????[5F][0123]-*) echo $guid $lfnbase-20.dat ;;
    ??????[5F][4567]-*) echo $guid $lfnbase-21.dat ;;
    ??????[5F][89AB]-*) echo $guid $lfnbase-22.dat ;;
    ??????[5F][CDEF]-*) echo $guid $lfnbase-23.dat ;;

    ??????[66][0123]-*) echo $guid $lfnbase-24.dat ;;
    ??????[66][4567]-*) echo $guid $lfnbase-25.dat ;;
    ??????[66][89AB]-*) echo $guid $lfnbase-26.dat ;;
    ??????[66][CDEF]-*) echo $guid $lfnbase-27.dat ;;

    ??????[77][0123]-*) echo $guid $lfnbase-28.dat ;;
    ??????[77][4567]-*) echo $guid $lfnbase-29.dat ;;
    ??????[77][89AB]-*) echo $guid $lfnbase-30.dat ;;
    ??????[77][CDEF]-*) echo $guid $lfnbase-31.dat ;;

    ??????[88][0123]-*) echo $guid $lfnbase-32.dat ;;
    ??????[88][4567]-*) echo $guid $lfnbase-33.dat ;;
    ??????[88][89AB]-*) echo $guid $lfnbase-34.dat ;;
    ??????[88][CDEF]-*) echo $guid $lfnbase-35.dat ;;

    ??????[99][0123]-*) echo $guid $lfnbase-36.dat ;;
    ??????[99][4567]-*) echo $guid $lfnbase-37.dat ;;
    ??????[99][89AB]-*) echo $guid $lfnbase-38.dat ;;
    ??????[99][CDEF]-*) echo $guid $lfnbase-39.dat ;;
  esac
done
