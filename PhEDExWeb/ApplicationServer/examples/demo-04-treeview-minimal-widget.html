<!DOCTYPE HTML PUBLIC “-//W3C//DTD HTML 4.01//EN” “http://www.w3.org/TR/html4/strict.dtd”>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <title>PhEDEx Web Interface</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-15" />

  <!-- YUI stylesheets-->
  <link rel="stylesheet" type="text/css" href="/yui/build/treeview/assets/skins/sam/treeview.css">
  <link rel="stylesheet" type="text/css" href="/yui/build/datatable/assets/skins/sam/datatable.css">
  <link rel="stylesheet" type="text/css" href="/yui/build/container/assets/container-core.css">
  <link rel="stylesheet" type="text/css" href="/yui/build/resize/assets/skins/sam/resize.css"> 
  <link rel="stylesheet" type="text/css" href="/yui/build/logger/assets/skins/sam/logger.css">
  <link rel="stylesheet" type="text/css" href="/yui/build/menu/assets/skins/sam/menu.css">
  <link rel="stylesheet" type="text/css" href="/yui/examples/treeview/assets/css/menu/tree.css">
  <link rel="stylesheet" type="text/css" href="/yui/build/button/assets/button-core.css">
  <link rel="stylesheet" type="text/css" href="/yui/build/assets/skins/sam/button.css">
  <link rel="stylesheet" type="text/css" href="/yui/build/fonts/fonts-min.css" />

  <!-- YUI libs -->
  <script type="text/javascript" src="/yui/build/yahoo-dom-event/yahoo-dom-event.js"></script>
  <script type="text/javascript" src="/yui/build/connection/connection-min.js"></script>
  <script type="text/javascript" src="/yui/build/json/json-min.js"></script>
  <script type="text/javascript" src="/yui/build/treeview/treeview-min.js"></script>
  <script type="text/javascript" src="/yui/build/logger/logger-min.js"></script>
  <script type="text/javascript" src="/yui/build/dragdrop/dragdrop-min.js"></script>
  <script type="text/javascript" src="/yui/build/element/element-min.js"></script>
  <script type="text/javascript" src="/yui/build/datasource/datasource-min.js"></script>
  <script type="text/javascript" src="/yui/build/datatable/datatable-min.js"></script>
  <script type="text/javascript" src="/yui/build/animation/animation-min.js"></script>
  <script type="text/javascript" src="/yui/build/container/container-min.js"></script>
  <script type="text/javascript" src="/yui/build/resize/resize-min.js"></script>
  <script type="text/javascript" src="/yui/build/menu/menu-min.js"></script>
  <script type="text/javascript" src="/yui/build/button/button-min.js"></script>

  <!-- PhEDEx stylesheets -->
  <link rel="stylesheet" type="text/css" href="/css/phedex.css">

  <!-- PhEDEx libs -->
  <script type="text/javascript" src="/js/phedex-base.js"></script>
  <script type="text/javascript" src="/js/phedex-core-logger.js"></script>
  <script type="text/javascript" src="/js/phedex-core-contextmenu.js"></script>
  <script type="text/javascript" src="/js/phedex-util.js"></script>
  <script type="text/javascript" src="/js/phedex-page.js"></script>
  <script type="text/javascript" src="/js/phedex-datasvc.js"></script>
  <script type="text/javascript" src="/js/phedex-event.js"></script>
  <script type="text/javascript" src="/js/phedex-core-control.js"></script>
  <script type="text/javascript" src="/js/phedex-core-filter.js"></script>
  <script type="text/javascript" src="/js/phedex-core-widget.js"></script>
  <script type="text/javascript" src="/js/phedex-core-widget-registry.js"></script>
  <script type="text/javascript" src="/js/phedex-core-widget-datatable.js"></script>
  <script type="text/javascript" src="/js/phedex-core-widget-treeview.js"></script>
  <script type="text/javascript" src="/js/phedex-widget-agents.js"></script>
  <script type="text/javascript" src="/js/phedex-widget-nodes.js"></script>
  <script type="text/javascript" src="/js/phedex-widget-linkview.js"></script>
  <script type="text/javascript" src="/js/phedex-widget-requestview.js"></script>
  <script type="text/javascript" src="/js/phedex-widget-template.js"></script>
</head>

<body class="yui-skin-sam">
 <div id='phedex-main'></div>

<script type="text/javascript">
// instantiate the page and other things when the DOM is ready!
YAHOO.util.Event.onDOMReady(function() {
  function random_int(min,max) {
    if ( !min ) { min = 0; }
    if ( !max ) { max = 999999999; }
    var i = Math.floor(Math.random()*(max-min)+min);
    return i;
  }
  function random_text(min,max) {
    if ( !min ) { min = 1; }
    if ( !max ) { max = 10; }
    var alphabet = 'abcdefghijklmnopqrstuvwxyz';
    var str = '';
    var i = random_int(min,max);
    for (var k=0; k<i; k++) {
      var j = random_int(0,alphabet.length);
      str += alphabet[j];
    }
    return str;
  }
  My = {};
  My.Widget = function(div,args) {
    var that = new PHEDEX.Core.Widget.TreeView( div, args );
    var width = 800;
    var branchDef1 = [
          {width: 80,text:'ID',          className:'phedex-tree-demo-id',          otherClasses:'align-left'},
          {width: 90,text:'Random Text', className:'phedex-tree-demo-random-text', otherClasses:'align-right'},
	  {width: 90,text:'More Text',   className:'phedex-tree-demo-more-text',   otherClasses:'align-right'}
      ];
    var branchDef2 = [
          {width: 80,text:'Thing ID',       className:'phedex-tree-thing-id',   otherClasses:'align-left'},
          {width:100,text:'Thing Name',     className:'phedex-tree-thing-name', otherClasses:'align-right'},
	  {width:150,text:'Thing Comments', className:'phedex-tree-thing-comments', hideByDefault:true}
      ];
    var branchDef3 = [
          {width:180,text:'Object Definition', className:'phedex-tree-object-definition', otherClasses:'align-right'},
          {width: 80,text:'Object Value',      className:'phedex-tree-object-value' },
	  {width:120,text:'Object Status',     className:'phedex-tree-object-status', otherClasses:'align-right'}
      ];

    that.buildTree(that.dom.content);

    that.buildExtra(that.dom.extra);

    that.buildHeader= function(div) {
      var root = that.headerTree.getRoot();
      var tNode1 = that.addNode( { width:width, format:branchDef1, name:'Top-level' }, null, root);    tNode1.expand();
      var tNode2 = that.addNode( {              format:branchDef2, name:'Thing' },     null, tNode1 ); tNode2.expand();
      var tNode3 = that.addNode( {              format:branchDef3, name:'Object' },    null, tNode2 ); tNode3.expand();
      tNode3.isLeaf = true;
      that.headerTree.render();
    }
    that.fillBody = function(div) {
      var tNode1, tNode2, tNode3;
      var root = that.tree.getRoot();
      var i = random_int(3,6);
      while ( i-->0 ) {
        tNode1 = that.addNode(
          {format:branchDef1}, [ random_int(10000,99999), random_text(10,30), random_text(10,20), ]
        );
        var j = random_int(3,6);
        while ( j-- > 0 ) {
          tNode2 = that.addNode(
            {format:branchDef2}, [ random_int(10000,99999), random_text(10,30), random_text(100,300), ], tNode1
          );
          var k = random_int(3,6);
          while ( k-- > 0 ) {
            tNode3 = that.addNode(
              {format:branchDef3}, [ random_int(10000,99999), random_int(10000,99999)/1000, random_text(100,300), ], tNode2
            );
          }
        }
      }
      that.tree.render();
    }

    that.update = function() {
      that.receive();
    }
    that.receive = function() {
      that.populate();
    }
    that.build();
    return that;
  }
  var widget = new My.Widget( 'phedex-main', {width:400, height:200, constraintoviewport:true, minwidth:250} );
      window.setTimeout( function() { widget.update(); }, 5000 );
});
</script>

</body>
</html>
