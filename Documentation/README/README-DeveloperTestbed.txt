{\rtf1\mac\ansicpg10000\uc1\deff0\stshfdbch0\stshfloch0\stshfhich0\stshfbi0\deflang1033\deflangfe1033{\upr{\fonttbl{\f0\fnil\fcharset256\fprq2{\*\panose 00020206030504050203}Times New Roman;}
{\f6\fnil\fcharset256\fprq2{\*\panose 00020005000000000000}Courier;}{\f15\fnil\fcharset78\fprq2 \'82l\'82r \'96\'be\'92\'a9;}}{\*\ud{\fonttbl{\f0\fnil\fcharset256\fprq2{\*\panose 00020206030504050203}Times New Roman;}
{\f6\fnil\fcharset256\fprq2{\*\panose 00020005000000000000}Courier;}{\f15\fnil\fcharset78\fprq2 \u-211 _\u-205 _ \u26126 _\u26397 _;}}}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;
\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}
{\stylesheet{\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \lang2057\langfe1033\cgrid\langnp2057\langfenp1033 \snext0 Normal;}{\*\cs10 \additive Default Paragraph Font;}{\*
\ts11\tsrowd\trftsWidthB3\trpaddl108\trpaddr108\trpaddfl3\trpaddft3\trpaddfb3\trpaddfr3\trcbpat1\trcfpat1\tscellwidthfts0\tsvertalt\tsbrdrt\tsbrdrl\tsbrdrb\tsbrdrr\tsbrdrdgl\tsbrdrdgr\tsbrdrh\tsbrdrv 
\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fs20\lang1024\langfe1024\cgrid\langnp1024\langfenp1024 \snext11 Normal Table;}{\s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 
\f6\lang2057\langfe1033\cgrid\langnp2057\langfenp1033 \sbasedon0 \snext15 \styrsid6378799 Plain Text;}}{\*\listtable{\list\listtemplateid-1201380266\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0
\levelindent0{\leveltext\leveltemplateid-451376472\'02\'00.;}{\levelnumbers\'01;}\chbrdr\brdrnone\brdrcf1 \chshdng0\chcfpat1\chcbpat1\fbias0 \fi-440\li800\jclisttab\tx800\lin800 }{\listlevel\levelnfc4\levelnfcn4\leveljc0\leveljcn0\levelfollow0
\levelstartat1\levelspace0\levelindent0{\leveltext\leveltemplateid67698713\'02\'01.;}{\levelnumbers\'01;}\chbrdr\brdrnone\brdrcf1 \chshdng0\chcfpat1\chcbpat1 \fi-360\li1440\jclisttab\tx1440\lin1440 }{\listlevel\levelnfc2\levelnfcn2\leveljc2\leveljcn2
\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\leveltemplateid67698715\'02\'02.;}{\levelnumbers\'01;}\chbrdr\brdrnone\brdrcf1 \chshdng0\chcfpat1\chcbpat1 \fi-180\li2160\jclisttab\tx2160\lin2160 }{\listlevel\levelnfc0\levelnfcn0\leveljc0
\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\leveltemplateid67698703\'02\'03.;}{\levelnumbers\'01;}\chbrdr\brdrnone\brdrcf1 \chshdng0\chcfpat1\chcbpat1 \fi-360\li2880\jclisttab\tx2880\lin2880 }{\listlevel\levelnfc4\levelnfcn4
\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\leveltemplateid67698713\'02\'04.;}{\levelnumbers\'01;}\chbrdr\brdrnone\brdrcf1 \chshdng0\chcfpat1\chcbpat1 \fi-360\li3600\jclisttab\tx3600\lin3600 }{\listlevel\levelnfc2
\levelnfcn2\leveljc2\leveljcn2\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\leveltemplateid67698715\'02\'05.;}{\levelnumbers\'01;}\chbrdr\brdrnone\brdrcf1 \chshdng0\chcfpat1\chcbpat1 \fi-180\li4320\jclisttab\tx4320\lin4320 }{\listlevel
\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\leveltemplateid67698703\'02\'06.;}{\levelnumbers\'01;}\chbrdr\brdrnone\brdrcf1 \chshdng0\chcfpat1\chcbpat1 \fi-360\li5040\jclisttab\tx5040\lin5040 }
{\listlevel\levelnfc4\levelnfcn4\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\leveltemplateid67698713\'02\'07.;}{\levelnumbers\'01;}\chbrdr\brdrnone\brdrcf1 \chshdng0\chcfpat1\chcbpat1 \fi-360\li5760
\jclisttab\tx5760\lin5760 }{\listlevel\levelnfc2\levelnfcn2\leveljc2\leveljcn2\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\leveltemplateid67698715\'02\'08.;}{\levelnumbers\'01;}\chbrdr\brdrnone\brdrcf1 \chshdng0\chcfpat1\chcbpat1 
\fi-180\li6480\jclisttab\tx6480\lin6480 }{\listname ;}\listid1356925417}}{\*\listoverridetable{\listoverride\listid1356925417\listoverridecount0\ls1}}{\*\rsidtbl \rsid662841\rsid5772644\rsid6378799\rsid12207247}{\info
{\title Node Testbed deployment and user guide}{\author Tim Barrass}{\operator Tim Barrass}{\creatim\yr2004\mo7\dy28\hr12\min36}{\revtim\yr2004\mo8\dy19\hr7\min45}{\version12}{\edmins33}{\nofpages5}{\nofwords930}{\nofchars5301}
{\*\company University of Bristol}{\nofcharsws6510}{\vern24577}}\margl359\margr359 \ftnbj\aenddoc\noxlattoyen\expshrtn\noultrlspc\dntblnsbdb\nospaceforul\hyphcaps0\formshade\horzdoc\dgmargin\dghspace180\dgvspace180\dghorigin1701\dgvorigin1984\dghshow0
\dgvshow0\jexpand\viewkind4\viewscale100\pgbrdrhead\pgbrdrfoot\splytwnine\ftnlytwnine\htmautsp\nolnhtadjtbl\useltbaln\alntblind\lytcalctblwd\lyttblrtgr\lnbrkrule\nobrkwrptbl\rsidroot12669697 \fet0\sectd 
\linex0\headery708\footery708\colsx708\endnhere\sectdefaultcl\sectrsid6378799\sftnbj {\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl2\pnucltr\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang
{\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang{\pntxta )}}{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl6\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl7
\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl8\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}\pard\plain 
\s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0\pararsid6378799 \f6\lang2057\langfe1033\cgrid\langnp2057\langfenp1033 {\dbch\f15\insrsid6378799\charrsid6378799 \hich\af6\dbch\af15\loch\f6 
Node Testbed deployment and user guide
\par }\pard\plain \ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0\pararsid6378799 \lang2057\langfe1033\cgrid\langnp2057\langfenp1033 {\dbch\f15\insrsid6378799\charrsid6378799 \hich\af0\dbch\af15\loch\f0 
========================================}{\f6\insrsid6378799 
\par }\pard\plain \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0\pararsid6378799 \f6\lang2057\langfe1033\cgrid\langnp2057\langfenp1033 {\dbch\f15\insrsid6378799\charrsid6378799 
\par \hich\af6\dbch\af15\loch\f6 1. Introduction
\par \hich\af6\dbch\af15\loch\f6 ---------------
\par 
\par \hich\af6\dbch\af15\loch\f6 
It is possible to set up a testbed network of PhEDEx distribution nodes on a single machine. The nodes manage Storage Elements which are simply local directories, copying files between them using cp. Files are registered in a testbed-global POOL XML catal
\hich\af6\dbch\af15\loch\f6 o\hich\af6\dbch\af15\loch\f6 gue (i.e. just an easily accessible file). Currently updates into an Oracle Transfer Management Database are used.
\par 
\par \hich\af6\dbch\af15\loch\f6 This document details the deployment and use of such a testbed system.
\par 
\par 
\par 
\par \hich\af6\dbch\af15\loch\f6 2. Deployment
\par \hich\af6\dbch\af15\loch\f6 -------------
\par 
\par \hich\af6\dbch\af15\loch\f6 This section details the process of s\hich\af6\dbch\af15\loch\f6 etting up a simple testbed, with a simple source of data, a simple sink of data and the management infrastructure needed to link agents together.
\par 
\par 
\par 
\par \hich\af6\dbch\af15\loch\f6 2a. Requirements
\par \hich\af6\dbch\af15\loch\f6 ----------------
\par 
\par \hich\af6\dbch\af15\loch\f6 Linux rh73 machine with gcc32
\par \hich\af6\dbch\af15\loch\f6 AFS access to CERN (for POOL File Catalogu\hich\af6\dbch\af15\loch\f6 e tools)
\par \hich\af6\dbch\af15\loch\f6 Access to Oracle clients
\par 
\par 
\par 
\par \hich\af6\dbch\af15\loch\f6 2a. TMDB deployment
\par \hich\af6\dbch\af15\loch\f6 -------------------
\par 
\par \hich\af6\dbch\af15\loch\f6 To do \loch\af6\dbch\af15\hich\f6 \u8230\'85
\par 
\par 
\par 
\par \hich\af6\dbch\af15\loch\f6 2b. Downloading the testbed tools
\par \hich\af6\dbch\af15\loch\f6 ---------------------------------
\par 
\par \hich\af6\dbch\af15\loch\f6 Begin to create the testbed directory structure. On your chosen testbed machine
\par 
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir /NodeTestbed
\par }{\dbch\f15\insrsid12207247\charrsid6378799 \tab \hich\af6\dbch\af15\loch\f6 cd NodeTestbed
\par }{\dbch\f15\insrsid6378799\charrsid6378799 
\par \tab \hich\af6\dbch\af15\loch\f6 setenv CVSROOT \\ \tab \tab \tab \tab :pserver:anonymous@cmscvs.cern.ch:/cvs_server/repositories/TMAgents
\par \tab 
\par \tab \hich\af6\dbch\af15\loch\f6 cvs login
\par \tab \tab \hich\af6\dbch\af15\loch\f6 [ password is 98passwd ]
\par \tab \hich\af6\dbch\af15\loch\f6 cvs co AgentToolkitExamples
\par 
\par \tab \hich\af6\dbch\af15\loch\f6 cd }{\dbch\f15\insrsid12207247\charrsid6378799 \hich\af6\dbch\af15\loch\f6 AgentToolkitExamples/NodeTestbed}{\dbch\f15\insrsid6378799\charrsid6378799 
\par \tab \hich\af6\dbch\af15\loch\f6 source SetupEnvironment.csh
\par }{\dbch\f15\insrsid12207247\charrsid6378799 \tab \hich\af6\dbch\af15\loch\f6 [\hich\af6\dbch\af15\loch\f6 setenv\hich\af6\dbch\af15\loch\f6  PATH \hich\af6\dbch\af15\loch\f6 $\{PATH\}:/NodeTestbed/\hich\af6\dbch\af15\loch\f6 
AgentToolkitExamples/NodeTestbed]
\par \tab \hich\af6\dbch\af15\loch\f6 [\hich\af6\dbch\af15\loch\f6 setenv\hich\af6\dbch\af15\loch\f6  PATH \hich\af6\dbch\af15\loch\f6 $\{PATH\}:/NodeTestbed/\hich\af6\dbch\af15\loch\f6 AgentToolkitExamples/\hich\af6\dbch\af15\loch\f6 Managers
\hich\af6\dbch\af15\loch\f6 ]
\par }{\dbch\f15\insrsid6378799\charrsid6378799 
\par 
\par 
\par 
\par \hich\af6\dbch\af15\loch\f6 2c. De\hich\af6\dbch\af15\loch\f6 ploying a simple (not full-functionality) source node
\par \hich\af6\dbch\af15\loch\f6 -----------------------------------------------------------
\par 
\par \hich\af6\dbch\af15\loch\f6 Now create a node. First we define the directory structure
\par 
\par \tab \hich\af6\dbch\af15\loch\f6 cd /NodeTestbed
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir TestbedSource1
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir TestbedSource1/scripts
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir TestbedSource1/logs
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir TestbedSource1/work
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir TestbedSource1/SE
\par 
\par \hich\af6\dbch\af15\loch\f6 Now register the node with the TMDB: in an SQL client
\par }{\dbch\f15\insrsid12207247\charrsid6378799 
\par \tab \hich\af6\dbch\af15\loch\f6 NodeManager.pl add-node \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -name TBSource1\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -host \hich\af6\dbch\af15\loch\f6 /NodeTestbed/TestbedSource1/SE\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -cat \hich\af6\dbch\af15\loch\f6 xmlcatalogue_file:/NodeTestbed/TestbedC\hich\af6\dbch\af15\loch\f6 atalogue.xml\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -db your DB TNS name\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -user your DB user\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -password your DB password\hich\af6\dbch\af15\loch\f6  
\par 
\par \tab }{\dbch\f15\insrsid6378799\charrsid6378799 
\par 
\par 
\par 
\par \hich\af6\dbch\af15\loch\f6 2d. Deploying a simple sink node
\par \hich\af6\dbch\af15\loch\f6 --------------------------------
\par 
\par \hich\af6\dbch\af15\loch\f6 Now create a simple sink node with a transfer agent. First define the directory structure
\par 
\par \tab \hich\af6\dbch\af15\loch\f6 cd /NodeTestbed
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir TestbedSink1
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir TestbedSink1/scripts
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir Testbed\hich\af6\dbch\af15\loch\f6 Sink1/logs
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir TestbedSink1/work
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir TestbedSink1/SE
\par 
\par \hich\af6\dbch\af15\loch\f6 Now register the node with the TMDB: in an SQL client
\par 
\par }{\dbch\f15\insrsid12207247\charrsid6378799 \tab \hich\af6\dbch\af15\loch\f6 NodeManager.pl add-node \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -name TBSink1\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -host \hich\af6\dbch\af15\loch\f6 /NodeTestbed/TestbedS\hich\af6\dbch\af15\loch\f6 ink\hich\af6\dbch\af15\loch\f6 1/SE\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -cat \hich\af6\dbch\af15\loch\f6 xmlcatalogue_file:/NodeTestbed/TestbedC\hich\af6\dbch\af15\loch\f6 atalogue.xml\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -neighbours TBSource1 \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -db your DB TNS name\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -user your DB user\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -password your DB password\hich\af6\dbch\af15\loch\f6  
\par }{\dbch\f15\insrsid6378799\charrsid6378799 
\par \hich\af6\dbch\af15\loch\f6 Now deploy the transfer agent
\par 
\par \tab \hich\af6\dbch\af15\loch\f6 cd TestbedSink1/scripts
\par \tab \hich\af6\dbch\af15\loch\f6 cp /NodeTestbed/AgentToolkitExamples/Dropbox/ExampleTransfer .
\par \tab \hich\af6\dbch\af15\loch\f6 cp /NodeTestbed/AgentToolkitExamples/Dropbox/ExampleTransferSlave .
\par 
\par \hich\af6\dbch\af15\loch\f6 The first is a master agent that handles the querying of the TMDB \hich\af6\dbch\af15\loch\f6 for new guids for transfer- it manages a pool of instances of the second, each of which handles a given transfer.
\par 
\par \hich\af6\dbch\af15\loch\f6 Now register the agent with the TMDB
\par \tab 
\par \tab \hich\af6\dbch\af15\loch\f6 insert into t_agents values (\lquote TBSink1_Transfer\rquote );}{\dbch\f15\insrsid5772644\charrsid6378799 
\par 
\par \hich\af6\dbch\af15\loch\f6 [ To do.. add description of deployment of routing agent\loch\af6\dbch\af15\hich\f6 \u8230\'85\hich\af6\dbch\af15\loch\f6  ]}{\dbch\f15\insrsid6378799\charrsid6378799 
\par }{\dbch\f15\insrsid5772644\charrsid6378799 
\par }{\dbch\f15\insrsid6378799\charrsid6378799 
\par 
\par \hich\af6\dbch\af15\loch\f6 2e. Deploying a simple management node
\par \hich\af6\dbch\af15\loch\f6 --------------------------------------
\par }{\dbch\f15\insrsid5772644\charrsid6378799 
\par \hich\af6\dbch\af15\loch\f6 Create a simple management node with allo\hich\af6\dbch\af15\loch\f6 cator agent. First define the directory structure
\par 
\par \tab \hich\af6\dbch\af15\loch\f6 cd /NodeTestbed
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir TestbedManagement
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir TestbedManagement/scripts
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir TestbedManagement/logs
\par \tab \hich\af6\dbch\af15\loch\f6 mkdir TestbedManagement/work
\par 
\par \hich\af6\dbch\af15\loch\f6 Note that the management node has no storage space, no SE.
\par 
\par \hich\af6\dbch\af15\loch\f6 Now regis\hich\af6\dbch\af15\loch\f6 ter the node with the TMDB: in an SQL client
\par }{\dbch\f15\insrsid12207247\charrsid6378799 
\par \tab \hich\af6\dbch\af15\loch\f6 NodeManager.pl add-node \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -name TB\hich\af6\dbch\af15\loch\f6 Management\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -host \hich\af6\dbch\af15\loch\f6 .\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -cat \hich\af6\dbch\af15\loch\f6 .\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -db your DB TNS name\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -user your DB user\hich\af6\dbch\af15\loch\f6  \\\\
\par \tab \tab \hich\af6\dbch\af15\loch\f6 -password your DB password\hich\af6\dbch\af15\loch\f6  
\par 
\par }{\dbch\f15\insrsid5772644\charrsid6378799 
\par \hich\af6\dbch\af15\loch\f6 [ To do\loch\af6\dbch\af15\hich\f6 \u8230\'85\hich\af6\dbch\af15\loch\f6  need to allow null entries here\loch\af6\dbch\af15\hich\f6 \u8230\'85\hich\af6\dbch\af15\loch\f6  ]
\par 
\par \hich\af6\dbch\af15\loch\f6 Now deploy the management script
\par 
\par \tab \hich\af6\dbch\af15\loch\f6 cd TestbedManagement/scripts
\par \tab \hich\af6\dbch\af15\loch\f6 cp /NodeTestbed/AgentToolkitExamples/\hich\af6\dbch\af15\loch\f6 Managers/Allocator.pl}{\dbch\f15\insrsid6378799\charrsid6378799 
\par 
\par }{\dbch\f15\insrsid5772644\charrsid6378799 
\par }{\dbch\f15\insrsid6378799\charrsid6378799 
\par \hich\af6\dbch\af15\loch\f6 3. }{\dbch\f15\insrsid5772644\charrsid6378799 \hich\af6\dbch\af15\loch\f6 One-time }{\dbch\f15\insrsid6378799\charrsid6378799 \hich\af6\dbch\af15\loch\f6 Use
\par \hich\af6\dbch\af15\loch\f6 ------}{\dbch\f15\insrsid5772644\charrsid6378799 \hich\af6\dbch\af15\loch\f6 ---------}{\dbch\f15\insrsid6378799\charrsid6378799 
\par 
\par 
\par 
\par \hich\af6\dbch\af15\loch\f6 3a. Making test data available at a simple source node
\par \hich\af6\dbch\af15\loch\f6 ------------------------------------------------------
\par 
\par \hich\af6\dbch\af15\loch\f6 Now create some test files residing at the simple source node
\par 
\par \tab \hich\af6\dbch\af15\loch\f6 cd /NodeTestbed/TestbedSource1/SE
\par \tab \hich\af6\dbch\af15\loch\f6 CreateTestFiles 5 TBSource1
\par 
\par \hich\af6\dbch\af15\loch\f6 The CreateTestFiles script (in the NodeTestbedToolkit dir) acts as a simple fake source of data, generating some testfiles, registering them with the file catalogue and then entering them into\hich\af6\dbch\af15\loch\f6 
 the TMDB.
\par }{\dbch\f15\insrsid5772644\charrsid6378799 
\par 
\par 
\par \hich\af6\dbch\af15\loch\f6 3a\rquote . Cleaning up- removing test data from a node
\par \hich\af6\dbch\af15\loch\f6 ------------------------------------------------
\par 
\par \hich\af6\dbch\af15\loch\f6 To remove test data from the system
\par \tab 
\par \tab \hich\af6\dbch\af15\loch\f6 cd /NodeTestbed/TestbedSource1/SE
\par \tab \hich\af6\dbch\af15\loch\f6 DeleteTestFiles
\par 
\par 
\par 
\par \hich\af6\dbch\af15\loch\f6 3b. Subsc\hich\af6\dbch\af15\loch\f6 ribing a sink node to certain data streams
\par \hich\af6\dbch\af15\loch\f6 ---------------------------------------------------
\par 
\par \hich\af6\dbch\af15\loch\f6 CreateTestFiles adds a metadata tag to each file it creates in the TMDB- in t_replica_metadata it sets the key POOL_dataset to NodeTestbedSet. A sink can subscr\hich\af6\dbch\af15\loch\f6 
ibe to a set of datasets by making an entry in the TMDB t_subscriptions table [this functionality will be offered by a web page].
\par 
\par \hich\af6\dbch\af15\loch\f6 In an SQL client
\par 
\par \tab \hich\af6\dbch\af15\loch\f6 insert into t_subscriptions values (\lquote TBSink1\rquote ,\rquote NodeTestbedSet\rquote );
\par 
\par 
\par 
\par \hich\af6\dbch\af15\loch\f6 3b. Using the allocator agent to alloc\hich\af6\dbch\af15\loch\f6 ate files to a sink node
\par \hich\af6\dbch\af15\loch\f6 --------------------------------------------------------------
\par 
\par \hich\af6\dbch\af15\loch\f6 We can run the allocator once to pick up the new files and allocate them to the sink based on the subscription information in the TMDB.
\par 
\par \tab \hich\af6\dbch\af15\loch\f6 cd /NodeTestbed/TestbedManage\hich\af6\dbch\af15\loch\f6 ment/scripts
\par \tab \hich\af6\dbch\af15\loch\f6 ./Allocator.pl \endash no-updates \endash once \endash period 1 \endash w ../work \\
\par }\pard \s15\ql \fi720\li720\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin720\itap0\pararsid5772644 {\dbch\f15\insrsid5772644\charrsid6378799 \endash \hich\af6\dbch\af15\loch\f6 db <your_tmdb_tnsname>}{\dbch\f15\insrsid662841\charrsid6378799 

\par \hich\af6\dbch\af15\loch\f6 -user <your tmdb username>
\par \hich\af6\dbch\af15\loch\f6 -passwd <your tmdb passwd>}{\dbch\f15\insrsid5772644\charrsid6378799 
\par }\pard \s15\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0\pararsid6378799 {\dbch\f15\insrsid5772644\charrsid6378799 \tab 
\par \hich\af6\dbch\af15\loch\f6 This runs the allocator agent once without making any updates on the TMDB\loch\af6\dbch\af15\hich\f6 \u8230\'85\hich\af6\dbch\af15\loch\f6  it should display a log indicat\hich\af6\dbch\af15\loch\f6 
ing that it found the 5 new files created above, and indicating which destinations it would allocate those files. Note that if we hadn\rquote t made a subscription above, and if we hadn\rquote 
t specified no-updates, the allocator would make a blank entry in the subscr\hich\af6\dbch\af15\loch\f6 i\hich\af6\dbch\af15\loch\f6 
ptions table to warn a distribution manager that a new dataset had entered distribution and needed toe be allocated to a destination\loch\af6\dbch\af15\hich\f6 \u8230\'85}{\dbch\f15\insrsid6378799\charrsid6378799 
\par 
\par 
\par \hich\af6\dbch\af15\loch\f6 3}{\dbch\f15\insrsid5772644\charrsid6378799 \hich\af6\dbch\af15\loch\f6 c}{\dbch\f15\insrsid6378799\charrsid6378799 \hich\af6\dbch\af15\loch\f6 . Using transfer agents to transfer data to a simple sink node
\par \hich\af6\dbch\af15\loch\f6 -------------------------------------------------------\hich\af6\dbch\af15\loch\f6 ---------}{\dbch\f15\insrsid5772644\charrsid6378799 
\par 
\par 
\par 
\par \hich\af6\dbch\af15\loch\f6 4. Steady-state use
\par \hich\af6\dbch\af15\loch\f6 -------------------}{\dbch\f15\insrsid6378799\charrsid6378799 
\par }}