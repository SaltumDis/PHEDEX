* Changes in PhEDEx 2.3.8

 General changes:
  - Considerably improved site configuration template.
  - Database handling changes:
    - Try harder to detect dead / unusable database connections.
    - When LogSQL is "on", print null values nicely.
  - Download agent changes:
    - Post-transfer deletes on failed transfer weren't working; fixed.
    - Timed out transfers now get 30 seconds to exit per signal sent.
  - Improvements to a configuration using pure SRM interface:
    - Download verification script trusts the exit code from the copy.
      The checking of download success using SRM was too expensive.
      Now also passes certificate proxy options to the srm-* commands.
    - Deletion script only deletes after failed transfer, no longer
      before every transfer as the latter was too expensive and post
      failure handling was considered good enough.  Now also passes
      certificate proxy options to the srm-* commands.
    - Migration agent rewritten.
    - Improvements to the stage-in agent.
    - Main export agent provided.
  - TestCatalogue did not correctly verify PFN-to-LFN, corrected.

 Web site changes:
  - Status browser updated for hosted with cmsdoc + mod_perl.  The
    transfer rate table now shows only one time span at a time.  Fixed
    the quoting of magic characters (<, >, etc.) in database report.
  - Various tweaks to the plots to better lay out the legend.
  - The legend in transfer queue page is now corrected to include only
    the items actually included in the plot.
  - The PHP plotting scripts are now hosted on cmsdoc.cern.ch.
  - Instructions for hosting the web site.

 Schema changes:
  - t_authorisation.role_name and t_info_agent_status.agent extended.
  - Performance data (t_*_histogram) older than about two days is now
    automatically compacted to time seris in 1-hour bins; newer data
    remains in the current 5-minute bins.

* Changes in PhEDEx 2.3.7

 General changes:
  - Template site configuration updated.
  - Download agent now defaults to 30 concurrent jobs.
  - Better handling of subprocesses on download agent exit.
  - File router and monitoring tweaked not to slow each other down.
  - Ftscp now handles timeout cancellation (= signal handling) and
    sleeps longer time as the download takes time.  The final FTS
    transfer status is now dumped to the output, i.e. PhEDEx logs.
    Ftscp ignores up to five glite-* server side errors to avoid
    death by intermittent glite server side database connection
    pooling problems.

 Web site change:
  - Rate page now allows source and/or destination to be filtered.
  - CERN network plots removed from the rate page.
  - Minor HTML improvements here and there.
  - Plots no longer have a black frame.

 Schema changes:
  - Nodes now have a new column 'kind' for administrative purposes.

* Changes in PhEDEx 2.3.6

 General changes:
  - Various improvements to ftscp.
  - Preliminary SRM-only agents for stage-in and tape migration.
  - Job manager changes for Castor stager agent: subprocess output
    receives "log" prefixing now only if explicitly requested.
  - Derek's catalogue test tool, slightly adapted.

 Web site change:
  - PHP scripts allowed more memory so link stats can be plotted.

 Schema changes: none.

* Changes in PhEDEx 2.3.5

 General changes:
  - Correction in handling -ignore/-accept options.  If a wildcard
    was used, not all matching nodes were filtered.
  - Download agent applies the -ignore/-accept option also when
    marking files wanted.  This makes no functional difference,
    but more correct.

 Schema changes: none.

* Changes in PhEDEx 2.3.4

 General changes:
  - Download agent improvements:
    - Log files are now prefixed by agent "boot time" so logs
      from different runs of the agent remain separate.
    - Globus backend got same logging improvements as SRM previously.

  - Block management agents:
    - Suspended blocks are now reactivated correctly if the suspend
      time (time_suspend_until) is reset to null, as opposed to just
      expiring.

  - Minor improvements to the status web browser.
    - The browser plots are now by destination by default, by link
      was too much information for default overall situation.  By
      link display is still recommended when filter for a site as
      it shows in one view all incoming and outgoing transfers.
    - Plot legend font size shrinks if many sites are included.
    - Remove rare warnings in daily stats generation.

 Schema changes:
  - INT2R TNS entries adjusted.
  - Further review of indexes.
  - t_xfer_replica authorisations corrected.
  - Certain tables are now partitioned by node.  The partitions are
    automatically added and removed by triggers on insert to or
    delete from t_node.

* Changes in PhEDEx 2.3.3

 General changes:
  - Download agent improvements:
    - The agent now uses from_node to determine to_pfn so the trivial
      file catalogue can offer different destination PFNs based on
      the source site using "destination-match".  This now reflects
      export side better: both download source and destination use a
      compatible convention.
    - Error logging has changed.  The log file for a failed transfer
      is now mentioned in the file transfer failure alert, not in a
      separate message.  The -validate etc. utility commands log the
      output directly to the main agent log, not separate log files.
      The agent now removes logs older than three days when the agent
      is idle (was 15 minutes of idle time).  The log for the transfer
      command now includes the full command line and the exit code.
      The log file prefixing scheme should no longer lose newlines.
    - Subprocess queue is no longer overfilled.  This should reduce
      the number of instances of time_transfer > timeout setting; the
      still runs only for the timeout period, the rest is queue wait.
    - Stopping the agent now correctly runs transfer validation.

  - File routing improvements:
    - The agent now routes only for nodes which have recently ran a
      download agent.  This prevents creation of routes for sites
      which are down, and therefore excessive transfer expiration.
    - File routing requests are now removed if the underlying dataset
      subscription has been suspended or removed.
    - Idle transfer requests with no file request are now removed.
      This prevents unnecessary transfers when routing changes, and
      automatically removes transfers when subscription is suspended.
    - If a file has already reached the destination, then removed,
      routes are now recreated automatically.  (See schema changes.)
    - Prevent race conditions with new file injection and routing.

  - Minor improvements to the status web browser.
    - Faster loading transfer rate page.
    - Transfer rate sorts by more values for better ordering.
    - Plot of pending transfer queue is now correct.

 Schema changes:
  - Additional trigger to reinsert transfer requests for removed replicas.
  - Corrected time in trigger to insert transfer requests for new files.
  - File routing tables enforce access only at CERN.

* Changes in PhEDEx 2.3.2

 General changes:
  - Update of "ftscp".
  - Download agent errors with -ignore/-accept options fixed.
  - Master now supports "kill" option, and can "renice" agents.
  - Database deadlocks with download/export agents should now be solved.
  - Improvements and minor fixes in the file routing algorithms.
  - Many performance optimisations and streamlining in various agents.
    Anything involving node filters (-nodes, -ignore, -accept) was
    reimplemented to be more database performance friendly.
  - Minor updates to the web pages and plots.
  - Some new tests have been included.

 Schema changes:
  - Database index review.  Many indexes have been added and removed.
  - t_dps_block_dest has a new 'state' column.
  - New trigger tr_xfer_file_insert, which inserts files for active
    block destinations automatically into t_xfer_request.
  - t_info_* tables now have constraints.
